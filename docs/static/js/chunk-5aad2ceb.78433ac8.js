(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5aad2ceb"],{1:function(e,t){},2:function(e,t){},3:function(e,t){},"3aa9":function(e,t,n){"use strict";n("71e0")},4:function(e,t){},5:function(e,t){},"5fa6":function(e,t,n){},6:function(e,t){},"66b9":function(e,t,n){"use strict";n("5fa6")},7:function(e,t){},"71e0":function(e,t,n){},a85d:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pdf"},["pdf"===e.docType?[n("pdf",{attrs:{url:e.docSrc}})]:e._e(),"video"===e.docType?[n("video-player",{attrs:{src:"https://cdn.theguardian.tv/webM/2015/07/20/150716YesMen_synd_768k_vp8.webm"}})]:e._e(),"image"===e.docType?[n("img",{staticClass:"image",attrs:{src:"https://picsum.photos/1000"}})]:e._e()],2)},a=[],r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pdf-view"},[n("div",{style:{width:e.pdfWidth,margin:"0 auto"}},e._l(e.totalPage,(function(e){return n("canvas",{key:e,attrs:{id:"pdfCanvas"+e}})})),0)])},o=[],c=(n("cb29"),n("f9cb")),s=n("8658"),u=n.n(s);c["GlobalWorkerOptions"].workerSrc=u.a;var d={name:"PDF",props:{url:{type:String,default:""},watermark:{type:String,default:"测试水印内容"}},data:function(){return{currentPage:1,totalPage:1,width:0,height:0,pdfWidth:"",pdfDoc:null,rendering:!1}},computed:{firstPage:function(){return this.currentPage<=1},lastPage:function(){return this.currentPage>=this.totalPage}},watch:{url:{handler:function(e){e&&this._initPdf()}}},mounted:function(){this._initPdf()},methods:{firstPageHandler:function(){this.firstPage||(this.currentPage=1,this._renderQueue())},lastPageHandler:function(){this.lastPage||(this.currentPage=this.totalPage,this._renderQueue())},previousPage:function(){this.firstPage||(this.currentPage--,this._renderQueue())},nextPage:function(){this.lastPage||(this.currentPage++,this._renderQueue())},_initPdf:function(){var e=this;c["getDocument"](this.url).promise.then((function(t){e.pdfDoc=t,e.totalPage=t.numPages,e.$nextTick((function(){e._renderPage()}))}))},_getRatio:function(e){var t=window.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return t/n},_getClientWidth:function(){var e=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width;return e-40},_renderPage:function(){var e=this;this.rendering=!0,this.pdfDoc.getPage(this.currentPage).then((function(t){var n=document.getElementById("pdfCanvas".concat(e.currentPage));if(n){var i=n.getContext("2d"),a=e._getRatio(i),r=e._getClientWidth(),o=t.getViewport({scale:1}).width,c=r/o;console.log("scale: ",c,a,r,t.view[2]*a,t.getViewport({scale:1}).width);var s=t.getViewport({scale:c});e.width=s.width*a,e.height=s.height*a,n.width=e.width,n.height=e.height,n.style.width=s.width+"px",n.style.height=s.height+"px",e.pdfWidth=s.width+"px",i.setTransform(a,0,0,a,0,0),t.render({canvasContext:i,viewport:s}).promise.then((function(){e.currentPage<e.totalPage&&(e.rendering=!1,e._renderWatermark(),e.currentPage+=1,e._renderPage())}))}}))},_renderQueue:function(){this.rendering||this._renderPage()},_initWatermark:function(){var e=document.createElement("canvas");e.width=200,e.height=200;var t=e.getContext("2d");return t.rotate(-18*Math.PI/180),t.font="14px Vedana",t.fillStyle="rgba(200, 200, 200, .3)",t.textAlign="left",t.textBaseline="middle",t.fillText(this.watermark,50,50),e},_renderWatermark:function(){var e=document.getElementById("pdfCanvas".concat(this.currentPage));if(e){var t=e.getContext("2d"),n=t.createPattern(this._initWatermark(),"repeat");t.rect(0,0,this.width,this.height),t.fillStyle=n,t.fill()}}}},l=d,h=(n("3aa9"),n("2877")),f=Object(h["a"])(l,r,o,!1,null,"39958bb0",null),g=f.exports,p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-player",{ref:"videoPlayer",staticClass:"video-player vjs-custom-skin",attrs:{playsinline:!0,options:e.playerOptions},on:{play:function(t){return e.onPlayerPlay(t)},pause:function(t){return e.onPlayerPause(t)},ended:function(t){return e.onPlayerEnded(t)}}})},P=[],m=n("5cd2"),y=(n("fda2"),n("451f"),{name:"VideoPlayer",components:{vPlayer:m["a"]},props:{src:{type:String,default:""}},data:function(){return{playerOptions:{height:350,playbackRates:[.7,1,1.5,2],autoplay:!1,muted:!1,loop:!1,preload:"auto",language:"zh-CN",aspectRatio:"16:9",fluid:!0,sources:[{type:"video/mp4",src:this.src}],poster:"",notSupportedMessage:"此视频暂无法播放，请稍后再试",controlBar:{timeDivider:!0,durationDisplay:!0,remainingTimeDisplay:!1,fullscreenToggle:!0}}}},computed:{player:function(){return this.$refs.videoPlayer.player}},methods:{onPlayerPlay:function(e){console.log("player play!",e)},onPlayerPause:function(e){console.log("player pause!",e)},onPlayerEnded:function(e){console.log("player ended!",e)}}}),v=y,w=Object(h["a"])(v,p,P,!1,null,"9aec7a2e",null),_=w.exports,k={name:"Document",components:{pdf:g,VideoPlayer:_},data:function(){return{docSrc:"",docType:""}},watch:{$route:function(){this.getDocData()}},created:function(){this.getDocData()},mounted:function(){},methods:{getDocData:function(){var e=this.$route.query,t=e.href,n=e.mime;this.docSrc=t,this.docType=n,console.log("docSrc:",this.docSrc,this.docType)}}},x=k,b=(n("66b9"),Object(h["a"])(x,i,a,!1,null,"726b2ce1",null));t["default"]=b.exports}}]);
//# sourceMappingURL=chunk-5aad2ceb.78433ac8.js.map